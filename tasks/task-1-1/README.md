# Задание 1.1

### Текущая архитектура

**[Context-Diagram.puml](initial-context-diagram.puml)**
| [SVG](https://plantuml.etservice.net/svg/jLDRInjH47xFhnZtAO5SiFJ91w7LLYqAeOtuKf2Jv3HPcjqDkoTLaO9HUe5QHUXJAKY5FlKbMhTTpKNm5yp-eyxCRe9QNnl2xjcPxynytrocRBVMwjGrD8rf1pEbagysYWtRD3lLJg3zckSQxPfYpNDAxPPoJSTf5G9JRzdLqjp3GfbDgolB9KS5HljaMf_Z6vkcs2PaPkf_H5Usg_qaVkQnrt7hoj_AShWWRrcGsywKwUYvOig3XSSumdwyZt_eVOQzU1T3x6DavSP0LNTibv4d6CRlS8WHNeh_RUP61Y9eNdc-Gy3hdtWI7-4LXVs45u3d57bmtGUBWtp5KRn3FdvoieYI3kbq276Nuk_6-tcOBZn8ldR8oS-UbOFj3D1leZ2xeQiKRqrNONM98ozMLfQ9r6rGLTLUQxVEYO_YpyGxf6Jd37-ctYWXz8tO3Ra6616TOKBv57jZS17mExbFoKr4c2AaDGfn88nto7MGXtWFhmHoHi8F1SWw_oqkEGSO0Vr9P1HtnJeWn0N4xvFgKtAgsLqvyzLiNHbLLO4cvlFfaLMKlS0qV1s8eX_2OiXw9CazRDbEVM4KAmvPSKGiXmJf0g57-6lIP-P0rOR2BAJrd875IgKCZyfBuaoj31Zpu-6Op4RJSvWmVc5HL8MFbFJmHiUPzPhzr2ujpArOkJkDNd-oQR9DhOpjDbviqQJpY2qctozT2CIKiapySgEXZDvGMuHTI4vtYoceGBk1nsjGqKvR-yfqVCr1nGpJwPrRsGkpQMYP_-UwbMvICezuJ0KUfMCRiJXMEP8cZwZnl3rX7WXmYVqIdb7nwG3a8p-lZ0mTOIWrnqwNBmaEP1G356U1Ype3ihxd72C-Y3-CBqjxUQkwqd2QB4Bqn0Go1Z9pac1IfnkhSYpiGnuGYjcxPu8m8WqZ_4sdP8eawMNIt_6AqQxtn7PHO7KWwv48PMlVolq5)

Диаграмма текущей архитектуры платформы «Тёплый дом».

- В основе системы монолитный бакенд на Java/Spring boot.
- База PostgreSQL хранит как состояние систем, так и телеметрию по датчикам, пользователей и тд
- Из задания не понятно как именно устройства подключены к системе.
  Могу предположить, что раз есть проблемы с подключением новых устройств (только с выздом мастера),
  то датчики подключаются вручную по проводному соединению к системе отопления,
  а сама система к серверу через проприетарный протокол (TCP/HTTP).

### Текущие проблемы

Бизнес хочет функциональное расширение (много различных датчиков и устройств).

- Для гибкого/быстрого подключения новых датчиков/устройств без участия техников нужно пересматривать архитектуру
  коммуникации устройств и серверной платформы. Переходить на устоявщиеся протоколы и решения в IoT.

- Текущая система согласно заданию работает синхронно (видимо это значит отправку состояния по таймеру,
  с ожиданием в ответе команд, например HTTP long polling). Это дает большую нагрузку на сервер, дороже масштабироовать,
  дает задерджки, большее потребление энергии устройствами, больше данных ходит.

- Текущая архитектура в виде единого монолита накладывает ограничение на скорость разработки,
  сложно добавлять новые устройства и бизнеслогику для них, тк необходимо это внедрять в общий код монолита,
  обновление (релизы) требуют полного тестирования всего монолита. Переход на микросервисы позволит
  запускать новые устройства и функционал независимо (например видео-наблюдение).

- Нагрузка может вырасти в десятки раз, текущее решение сложно и доррого масштабировать (как по ресурсам разработки так
  и по железу), если оставаться в монолите:
    - используется общая база как для телеметрии так и для основной логики, по крайней мере нужно выносить
      хранение телеметрии в отдельную базу и сервис.
    - Один и тот же бакенд реализует и API бизнеслогики/портала и держит соединения с устрйоствами,
      пиковые нагрузки с устройств будут непредсказуемо аффектить весь бакенд превышая лимиты по числу соединений.
    - Мониторинг и оперативное решение проблем с нагрузкой проблематично, если система встанет колом имея на рукух
      монолит, разработчикам будет сложно оперативно это решить (тк будет не пояно куда конкретно уходит CPU/RAM,
      а если и понятно то оперативно решить будет сложно нежели в случае отдельных сервисов).

### План развития

Описан в [Части 1.2](../task-1-2/README.md)